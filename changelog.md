- many small internal improvements and misc fixes